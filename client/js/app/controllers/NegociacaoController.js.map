{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacaoList","Negociacao","Mensagem","NegociacoesView","MensagemView","NegociacaoService","DateHelper","Bind","NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_actualColumn","_service","_mensagem","_negociacoesList","_init","load","setInterval","import","loadAll","then","negociacoes","forEach","add","negociacao","catch","texto","error","event","preventDefault","save","_createNegociacao","_cleanForm","deleteAll","clean","message","column","reverse","orderBy","a","b","textToDate","value","parseInt","parseFloat","focus","negociacaoController","currentInstance"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["import { NegociacaoList } from '../models/NegociacaoList';\nimport { Negociacao } from '../models/Negociacao';\nimport { Mensagem } from '../models/Mensagem';\nimport { NegociacoesView } from '../views/NegociacoesView';\nimport { MensagemView } from '../views/MensagemView';\nimport { NegociacaoService } from '../services/NegociacaoService';\nimport { DateHelper } from '../helpers/DateHelper';\nimport { Bind } from '../helpers/Bind';\n\nclass NegociacaoController {\n\tconstructor() {\n\t\tlet $ = document.querySelector.bind(document);\n\t\tthis._inputData = $('#data');\n\t\tthis._inputQuantidade = $('#quantidade');\n\t\tthis._inputValor = $('#valor');\n\t\tthis._actualColumn = '';\n\t\tthis._service = new NegociacaoService();\n\t\tthis._mensagem = new Bind(new Mensagem(), new MensagemView($('#mensagemView')), 'texto');\n\t\tthis._negociacoesList = new Bind(\n\t\t\tnew NegociacaoList(),\n\t\t\tnew NegociacoesView($('#negociacoesView')),\n\t\t\t'add',\n\t\t\t'clean',\n\t\t\t'orderBy',\n\t\t\t'reverse'\n\t\t);\n\t\tthis._init();\n\t}\n\n\t_init() {\n\t\tthis.load();\n\t\tsetInterval(() => {\n\t\t\tthis.import();\n\t\t}, 1000);\n\t}\n\n\tload() {\n\t\tthis._service\n\t\t\t.loadAll()\n\t\t\t.then(negociacoes =>\n\t\t\t\tnegociacoes.forEach(negociacao => this._negociacoesList.add(negociacao))\n\t\t\t)\n\t\t\t.catch(error => (this._mensagem.texto = error));\n\t}\n\n\tadd(event) {\n\t\tevent.preventDefault();\n\t\tthis._service\n\t\t\t.save(this._createNegociacao())\n\t\t\t.then(negociacao => {\n\t\t\t\tthis._negociacoesList.add(negociacao);\n\t\t\t\tthis._mensagem.texto = 'Negociação adicionada com sucesso!';\n\t\t\t\tthis._cleanForm();\n\t\t\t})\n\t\t\t.catch(error => (this._mensagem.texto = error));\n\t}\n\n\tremove(event) {\n\t\tthis._service\n\t\t\t.deleteAll()\n\t\t\t.then(message => {\n\t\t\t\tthis._negociacoesList.clean();\n\t\t\t\tthis._mensagem.texto = message;\n\t\t\t})\n\t\t\t.catch(error => (this._mensagem.texto = error));\n\t}\n\n\timport() {\n\t\tthis._service\n\t\t\t.import(this._negociacoesList)\n\t\t\t.then(negociacoes => {\n\t\t\t\tnegociacoes.forEach(negociacao => this._negociacoesList.add(negociacao));\n\t\t\t\tthis._mensagem.texto = 'Negociações do período importadas com sucesso';\n\t\t\t})\n\t\t\t.catch(error => (this._mensagem.texto = error));\n\t}\n\n\torderBy(column) {\n\t\tif (column == this._actualColumn) {\n\t\t\tthis._negociacoesList.reverse();\n\t\t} else {\n\t\t\tthis._negociacoesList.orderBy((a, b) => a[column] - b[column]);\n\t\t}\n\t\tthis._actualColumn = column;\n\t}\n\n\t_createNegociacao() {\n\t\treturn new Negociacao(\n\t\t\tDateHelper.textToDate(this._inputData.value),\n\t\t\tparseInt(this._inputQuantidade.value),\n\t\t\tparseFloat(this._inputValor.value)\n\t\t);\n\t}\n\n\t_cleanForm() {\n\t\tthis._inputData.value = '';\n\t\tthis._inputQuantidade.value = 1;\n\t\tthis._inputValor.value = 0.0;\n\t\tthis._inputData.focus();\n\t}\n}\n\nlet negociacaoController = new NegociacaoController();\n\nexport function currentInstance() {\n\treturn negociacaoController;\n}\n"]}