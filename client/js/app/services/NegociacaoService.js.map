{"version":3,"sources":["../../app-es6/services/NegociacaoService.js"],"names":["NegociacaoService","_baseUrl","_http","HttpService","Promise","all","getWeekNegociacoes","getLastWeekNegociacoes","getLastWeekBeforeNegociacoes","then","negociacoes","reduce","flatArray","array","concat","catch","Error","error","get","map","Negociacao","Date","item","data","quantidade","valor","console","log","xhr","responseText","negociacao","ConnectionFactory","getConnection","NegociacaoDao","connection","dao","save","deleteAll","getAll","list","getAllNegociacoes","filter","exists","newNegociacao"],"mappings":";;;;;;IAAMA,iB;AACL,8BAAc;AAAA;;AACb,OAAKC,QAAL,GAAgB,aAAhB;AACA,OAAKC,KAAL,GAAa,IAAIC,WAAJ,EAAb;AACA;;;;sCAEmB;AACnB,UAAOC,QAAQC,GAAR,CAAY,CAClB,KAAKC,kBAAL,EADkB,EAElB,KAAKC,sBAAL,EAFkB,EAGlB,KAAKC,4BAAL,EAHkB,CAAZ,EAKLC,IALK,CAKA;AAAA,WACLC,YAAYC,MAAZ,CAAmB,UAACC,SAAD,EAAYC,KAAZ;AAAA,YAAsBD,UAAUE,MAAV,CAAiBD,KAAjB,CAAtB;AAAA,KAAnB,EAAkE,EAAlE,CADK;AAAA,IALA,EAQLE,KARK,CAQC;AAAA,WAAS,IAAIC,KAAJ,CAAUC,KAAV,CAAT;AAAA,IARD,CAAP;AASA;;;uCAEoB;AACpB,UAAO,KAAKf,KAAL,CACLgB,GADK,CACE,KAAKjB,QADP,cAELQ,IAFK,CAEA;AAAA,WACLI,MAAMM,GAAN,CAAU;AAAA,YAAQ,IAAIC,UAAJ,CAAe,IAAIC,IAAJ,CAASC,KAAKC,IAAd,CAAf,EAAoCD,KAAKE,UAAzC,EAAqDF,KAAKG,KAA1D,CAAR;AAAA,KAAV,CADK;AAAA,IAFA,EAKLV,KALK,CAKC,iBAAS;AACfW,YAAQC,GAAR,CAAYC,IAAIC,YAAhB;AACA,UAAM,IAAIb,KAAJ,CAAU,kDAAV,CAAN;AACA,IARK,CAAP;AASA;;;2CAEwB;AACxB,UAAO,KAAKd,KAAL,CACLgB,GADK,CACE,KAAKjB,QADP,gBAELQ,IAFK,CAEA;AAAA,WACLI,MAAMM,GAAN,CAAU;AAAA,YAAQ,IAAIC,UAAJ,CAAe,IAAIC,IAAJ,CAASC,KAAKC,IAAd,CAAf,EAAoCD,KAAKE,UAAzC,EAAqDF,KAAKG,KAA1D,CAAR;AAAA,KAAV,CADK;AAAA,IAFA,EAKLV,KALK,CAKC,iBAAS;AACfW,YAAQC,GAAR,CAAYC,IAAIC,YAAhB;AACA,UAAM,IAAIb,KAAJ,CAAU,2DAAV,CAAN;AACA,IARK,CAAP;AASA;;;iDAE8B;AAC9B,UAAO,KAAKd,KAAL,CACLgB,GADK,CACE,KAAKjB,QADP,iBAELQ,IAFK,CAEA;AAAA,WACLI,MAAMM,GAAN,CAAU;AAAA,YAAQ,IAAIC,UAAJ,CAAe,IAAIC,IAAJ,CAASC,KAAKC,IAAd,CAAf,EAAoCD,KAAKE,UAAzC,EAAqDF,KAAKG,KAA1D,CAAR;AAAA,KAAV,CADK;AAAA,IAFA,EAKLV,KALK,CAKC,iBAAS;AACfW,YAAQC,GAAR,CAAYC,IAAIC,YAAhB;AACA,UAAM,IAAIb,KAAJ,CAAU,kDAAV,CAAN;AACA,IARK,CAAP;AASA;;;uBAEIc,U,EAAY;AAChB,UAAOC,kBAAkBC,aAAlB,GACLvB,IADK,CACA;AAAA,WAAc,IAAIwB,aAAJ,CAAkBC,UAAlB,CAAd;AAAA,IADA,EAELzB,IAFK,CAEA;AAAA,WAAO0B,IAAIC,IAAJ,CAASN,UAAT,CAAP;AAAA,IAFA,EAGLf,KAHK,CAGC;AAAA,WAAS,IAAIC,KAAJ,CAAUC,KAAV,CAAT;AAAA,IAHD,CAAP;AAIA;;;8BAEW;AACX,UAAOc,kBAAkBC,aAAlB,GACLvB,IADK,CACA;AAAA,WAAc,IAAIwB,aAAJ,CAAkBC,UAAlB,CAAd;AAAA,IADA,EAELzB,IAFK,CAEA;AAAA,WAAO0B,IAAIE,SAAJ,EAAP;AAAA,IAFA,EAGLtB,KAHK,CAGC;AAAA,WAAS,IAAIC,KAAJ,CAAUC,KAAV,CAAT;AAAA,IAHD,CAAP;AAIA;;;4BAES;AACT,UAAOc,kBAAkBC,aAAlB,GACLvB,IADK,CACA;AAAA,WAAc,IAAIwB,aAAJ,CAAkBC,UAAlB,CAAd;AAAA,IADA,EAELzB,IAFK,CAEA;AAAA,WAAO0B,IAAIG,MAAJ,EAAP;AAAA,IAFA,EAGLvB,KAHK,CAGC;AAAA,WAAS,IAAIC,KAAJ,CAAUC,KAAV,CAAT;AAAA,IAHD,CAAP;AAIA;;;0BAEMsB,I,EAAM;AACZ,UAAO,KAAKC,iBAAL,GACL/B,IADK,CACA;AAAA,WAAeC,YAAY+B,MAAZ,CAAmB;AAAA,YAAiB,CAACF,KAAKG,MAAL,CAAYC,aAAZ,CAAlB;AAAA,KAAnB,CAAf;AAAA,IADA,EAEL5B,KAFK,CAEC;AAAA,WAAS,IAAIC,KAAJ,CAAUC,KAAV,CAAT;AAAA,IAFD,CAAP;AAGA","file":"NegociacaoService.js","sourcesContent":["class NegociacaoService {\n\tconstructor() {\n\t\tthis._baseUrl = 'negociacoes';\n\t\tthis._http = new HttpService();\n\t}\n\n\tgetAllNegociacoes() {\n\t\treturn Promise.all([\n\t\t\tthis.getWeekNegociacoes(),\n\t\t\tthis.getLastWeekNegociacoes(),\n\t\t\tthis.getLastWeekBeforeNegociacoes()\n\t\t])\n\t\t\t.then(negociacoes =>\n\t\t\t\tnegociacoes.reduce((flatArray, array) => flatArray.concat(array), [])\n\t\t\t)\n\t\t\t.catch(error => new Error(error));\n\t}\n\n\tgetWeekNegociacoes() {\n\t\treturn this._http\n\t\t\t.get(`${this._baseUrl}/semana`)\n\t\t\t.then(array =>\n\t\t\t\tarray.map(item => new Negociacao(new Date(item.data), item.quantidade, item.valor))\n\t\t\t)\n\t\t\t.catch(error => {\n\t\t\t\tconsole.log(xhr.responseText);\n\t\t\t\tthrow new Error('Não foi possível obter as negociações da semana.');\n\t\t\t});\n\t}\n\n\tgetLastWeekNegociacoes() {\n\t\treturn this._http\n\t\t\t.get(`${this._baseUrl}/anterior`)\n\t\t\t.then(array =>\n\t\t\t\tarray.map(item => new Negociacao(new Date(item.data), item.quantidade, item.valor))\n\t\t\t)\n\t\t\t.catch(error => {\n\t\t\t\tconsole.log(xhr.responseText);\n\t\t\t\tthrow new Error('Não foi possível obter as negociações da semana anterior.');\n\t\t\t});\n\t}\n\n\tgetLastWeekBeforeNegociacoes() {\n\t\treturn this._http\n\t\t\t.get(`${this._baseUrl}/retrasada`)\n\t\t\t.then(array =>\n\t\t\t\tarray.map(item => new Negociacao(new Date(item.data), item.quantidade, item.valor))\n\t\t\t)\n\t\t\t.catch(error => {\n\t\t\t\tconsole.log(xhr.responseText);\n\t\t\t\tthrow new Error('Não foi possível obter as negociações da semana.');\n\t\t\t});\n\t}\n\n\tsave(negociacao) {\n\t\treturn ConnectionFactory.getConnection()\n\t\t\t.then(connection => new NegociacaoDao(connection))\n\t\t\t.then(dao => dao.save(negociacao))\n\t\t\t.catch(error => new Error(error));\n\t}\n\n\tdeleteAll() {\n\t\treturn ConnectionFactory.getConnection()\n\t\t\t.then(connection => new NegociacaoDao(connection))\n\t\t\t.then(dao => dao.deleteAll())\n\t\t\t.catch(error => new Error(error));\n\t}\n\n\tloadAll() {\n\t\treturn ConnectionFactory.getConnection()\n\t\t\t.then(connection => new NegociacaoDao(connection))\n\t\t\t.then(dao => dao.getAll())\n\t\t\t.catch(error => new Error(error));\n\t}\n\n\timport(list) {\n\t\treturn this.getAllNegociacoes()\n\t\t\t.then(negociacoes => negociacoes.filter(newNegociacao => !list.exists(newNegociacao)))\n\t\t\t.catch(error => new Error(error));\n\t}\n}\n"]}